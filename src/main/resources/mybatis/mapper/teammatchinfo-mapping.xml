<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="teammatchinfo.TeamMatchInfoDAO">

	<!-- 수락을 기다리는 경기 -->
	
	<select id="getTeamMatchList1" resultType="teammatchdto">
		select * from teammatching where homeName=#{myTeamName} and awayName is not null and registration=1 and acceptance=0
		order by possibleDate asc, possibleTime asc
	</select>
	
	<!-- 등록한 경기 -->
	
	<select id="getTeamMatchList2" resultType="teammatchdto">
		select * from teammatching where homeName=#{myTeamName} and awayName is null and registration=0
		order by possibleDate asc, possibleTime asc
	</select>
	
	<!-- 신청한 경기 -->
	
	<select id="getTeamMatchList3" resultType="teammatchdto">
		select * from teammatching where awayName=#{myTeamName} and registration=1
		order by possibleDate asc, possibleTime asc
	</select>
	
	<!-- 예정된 경기 -->
	
	<select id="getTeamMatchList4" resultType="teammatchdto">
		select * from teammatching where (homeName=#{myTeamName} and awayName is not null and registration is not null and acceptance is not null)
		or (awayName=#{myTeamName} and registration=1 and acceptance=1)
		order by possibleDate asc, possibleTime asc
	</select>

	
	<!-- 지난 경기 -->
	
	<select id="getTeamMatchList5" resultType="teammatchdto">
		select * from teammatching where (homeName=#{myTeamName} and winner is not null and loser is not null)
		or (awayName=#{myTeamName} and winner is not null and loser is not null)
		order by possibleDate asc, possibleTime asc
	</select>
	
	<!-- 1. 수락을 기다리는 경기 > 수락하기 버튼 -->
	
	<update id="updateAcceptance">
		update teammatching set acceptance=1 where seq=#{seq}
	</update>
	
	<!-- 2. 등록한 경기 > 취소 버튼 -->
	
	<delete id="deleteTeammatchRegistration">
		delete from teammatching where seq=#{seq}
	</delete>
	
	<!-- 3. 신청한 경기 > 취소하기 버튼 -->
	
	<update id="deleteAddTeammatch">
		update teammatching set registration=0, awayName=null where seq=#{seq}
	</update>
	
	<!-- 4. 예정된 경기 > 취소하기 버튼 -->
	
	<update id="cancelTeammatch">
		update teammatching set registration=0, acceptance=0, awayName=null where seq=#{seq}
	</update>
</mapper>